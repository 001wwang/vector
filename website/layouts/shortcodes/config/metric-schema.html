{{ $schema := site.Data.docs.data_model.schema.metric }}

<div class="no-prose border rounded flex flex-col divide-y dark:border-gray-700 dark:divide-gray-700">
  {{ range $k, $v := $schema.type.object.options }}
  {{ $name := $k }}
  <div class="py-4 px-6">
    <span class="flex items-center justify-between">
      <span>
        <h3 id="{{ $name }}" class="font-semibold font-mono text-sm dark:text-primary">
          <a href="#{{ $name }}">
            {{ $name }}
          </a>
        </h3>
      </span>

      <span class="flex space-x-1">
        {{ if $v.common }}
        {{ partial "badge.html" (dict "word" "common" "color" "indigo") }}
        {{ end }}

        {{ if $v.required }}
        {{ partial "badge.html" (dict "word" "required" "color" "red") }}
        {{ else }}
        {{ partial "badge.html" (dict "word" "optional" "color" "gray") }}
        {{ end }}

        {{ range $k, $v := $v.type }}
        {{ $type := cond (eq $k "object") "table" $k }}
        {{ partial "badge.html" (dict "word" $type "color" "green") }}
        {{ end }}
      </span>
    </span>

    {{ with $v.description }}
    <div class="mt-3">
      {{ . | markdownify }}
    </div>
    {{ end }}

    {{ range $k, $v := $v.type }}
    {{ if eq $k "object" }}
    <div class="mt-3">
      <div class="border rounded flex flex-col divide-y dark:border-gray-700 dark:divide-gray-700">
        {{ range $k, $v := $v.options }}
        {{ $id := printf "%s-%s" $name $k }}
        <div class="py-3 px-5">
          <span class="flex justify-between items-center">
            <span class="font-mono font-semibold">
              <h4 id="{{ $id }}">
                <a href="#{{ $id }}">
                  {{ $k }}
                </a>
              </h4>
            </span>

            <span class="flex space-x-1">
              {{ if $v.required }}
              {{ partial "badge.html" (dict "word" "required" "color" "red") }}
              {{ else }}
              {{ partial "badge.html" (dict "word" "optional" "color" "gray") }}
              {{ end }}

              {{ range $k, $v := $v.type }}
              {{ partial "badge.html" (dict "word" $k "color" "green") }}

              {{ with $v.syntax }}
              {{ partial "badge.html" (dict "word" . "color" "gray") }}
              {{ end }}

              {{ if $v.enum }}
              {{ partial "badge.html" (dict "word" "enum" "color" "yellow") }}
              {{ end }}
              {{ end }}
            </span>
          </span>

          <div class="prose dark:prose-dark">
            {{ $v.description | markdownify }}
          </div>

          {{ range $k, $v := $v.type }}
          {{ with $v.examples }}
          <div class="mt-2">
            <span class="font-semibold">
              Examples
            </span>

            <span class="flex space-x-2">
              {{ range . }}
              <span class="font-mono text-sm text-secondary dark:text-primary">
                {{ . }}
              </span>
              {{ end }}
            </span>
          </div>
          {{ end }}
          {{ end }}
        </div>
        {{ end }}
      </div>
    </div>
    {{ end }}
    {{ end }}
  </div>
  {{ end }}
</div>