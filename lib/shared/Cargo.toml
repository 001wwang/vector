[package]
name = "shared"
version = "0.1.0"
authors = ["Vector Contributors <vector@timber.io>"]
edition = "2018"
publish = false
license = "MPL-2.0"

[dependencies]
bytes = { version = "0.5.6", optional = true }
chrono = { version = "0.4", optional = true }
chrono-tz = "0.5.3"
derivative = "2.1.3"
nom = { version = "6", optional = true }
snafu = { version = "0.6", optional = true }
tracing = { version = "0.1", optional = true }
vrl = { path = "../vrl/core" }
pest = { version = "2.1.3", optional = true }
pest_derive = { version = "2.1.0", optional = true }
serde = { version = "1.0.117", features = ["derive"], optional = true }
indexmap = {version = "1.5.1", features = ["serde-1"], optional = true }
toml = { version = "0.5.7", optional = true }
derive_is_enum_variant = { version = "0.1.1", optional = true }
serde_json = { version = "1.0.33", features = ["raw_value"], optional = true }
metrics = { version = "0.13.0-alpha.8", optional = true }
metrics-util = { version = "0.4.0-alpha.6", optional = true  }
rlua = { git = "https://github.com/kyren/rlua", rev = "25bd7e6bffef9597466a98bfca80a3056c9e6320", optional = true }
lazy_static = { version = "1.3.0", optional = true }

[dev-dependencies]
test-env-log = { version = "0.2.3", default-features = false, features = ["trace"] }
tracing-subscriber = {version = "0.2", features = ["chrono", "env-filter", "fmt"] }

[features]
default = [
  "aws_cloudwatch_logs_subscription",
  "btreemap",
  "conversion",
  "tokenize",
  "event",
]

aws_cloudwatch_logs_subscription = [
  "chrono/serde",
  "serde/derive",
]

btreemap = []

conversion = [
  "bytes",
  "chrono",
  "snafu",
  "tracing",
]

tokenize = [
  "nom",
]

event = [
  "pest",
  "pest_derive",
  "serde",
  "indexmap",
  "toml",
  "derive_is_enum_variant",
  "serde_json",
  "metrics",
  "metrics-util",
  "rlua",
  "bytes/serde",
  "chrono",
  "snafu",
  "tracing/attributes",
  "lazy_static",
]
